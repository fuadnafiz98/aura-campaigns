import{r as d,$ as A,j as e,B as b,a0 as y,a as T,b as D,C as L,c as F,d as M,e as P,f as I,g as E}from"./index-BhShMgCK.js";import{a as v}from"./api-CEFOjK8t.js";import{T as B,a as H,b as j,c as N,d as O,e as x}from"./table-CbE_oz1G.js";import{D as Q,e as $,f as q,g as R,h as V,i as _,S as z,a as G,b as J,c as K,d as h}from"./dialog-WUoby_ld.js";import{I as w}from"./input-BHxjlcNQ.js";import{L as S,P as U}from"./label-DNKLp33a.js";import{T as W,S as X}from"./textarea-C0PX_CFT.js";import{L as Y}from"./loader-circle-Bi8eq0Fz.js";import{u as Z,F as ee}from"./funnel-BQjfxwF7.js";import"./index-Bnoxgq91.js";function ae({open:o,onOpenChange:p}){const[r,m]=d.useState(""),[u,c]=d.useState(""),[n,i]=d.useState(!1),[a,l]=d.useState({}),g=A(v.campaigns.createCampaign),C=()=>{const t={};return r.trim()?r.length<3&&(t.name="Campaign name must be at least 3 characters"):t.name="Campaign name is required",u.trim()||(t.targetAudience="Target audience is required"),l(t),Object.keys(t).length===0},f=async t=>{if(t.preventDefault(),!!C()){i(!0);try{await g({name:r.trim(),targetAudience:u.trim(),status:"draft"}),y.success(`Successfully created campaign "${r}"`),m(""),c(""),l({}),p(!1)}catch(k){console.error("Failed to create campaign:",k),y.error("Failed to create campaign. Please try again.")}finally{i(!1)}}},s=()=>{n||(m(""),c(""),l({}),p(!1))};return e.jsx(Q,{open:o,onOpenChange:s,children:e.jsx($,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:t=>{f(t)},children:[e.jsxs(q,{children:[e.jsx(R,{children:"Create New Campaign"}),e.jsx(V,{children:"Create a new email campaign by providing a name and defining your target audience."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:"campaign-name",children:"Campaign Name"}),e.jsx(w,{id:"campaign-name",placeholder:"e.g., Summer Sale 2024",value:r,onChange:t=>{m(t.target.value),a.name&&l({...a,name:void 0})},disabled:n,className:a.name?"border-destructive":""}),a.name&&e.jsx("p",{className:"text-sm text-destructive",children:a.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:"target-audience",children:"Target Audience"}),e.jsx(W,{id:"target-audience",placeholder:"Describe your target audience (e.g., Small business owners in tech industry, ages 25-45)",value:u,onChange:t=>{c(t.target.value),a.targetAudience&&l({...a,targetAudience:void 0})},disabled:n,className:a.targetAudience?"border-destructive":"",rows:3}),a.targetAudience&&e.jsx("p",{className:"text-sm text-destructive",children:a.targetAudience})]})]}),e.jsxs(_,{children:[e.jsx(b,{type:"button",variant:"outline",onClick:s,disabled:n,children:"Cancel"}),e.jsxs(b,{type:"submit",className:"cursor-pointer",disabled:n,children:[n&&e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Creating...":"Create Campaign"]})]})]})})})}const ue=()=>{const[o,p]=d.useState("all"),[r,m]=d.useState(""),[u,c]=d.useState(!1),n=T(),{results:i,status:a,loadMore:l,isLoading:g}=Z(v.campaigns.getCampaigns,{filterStatus:o,searchQuery:r},{initialNumItems:10}),C=D(v.campaigns.getCampaignsCount,{filterStatus:o,searchQuery:r}),f=()=>{console.log("Add new campaign"),c(!0)};return e.jsxs(L,{className:"border-border m-4",children:[e.jsx(F,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-sm",children:"Campaigns"}),e.jsxs(P,{className:"text-sm",children:["Showing ",i.length," of ",C??0," campaigns"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(X,{className:"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(w,{placeholder:"Search campaigns...",value:r,onChange:s=>m(s.target.value),className:"h-9 pl-8 text-sm border-border"})]}),e.jsxs(z,{value:o,onValueChange:p,children:[e.jsxs(G,{className:"w-36 h-7 cursor-pointer border-border text-sm",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),e.jsx(J,{})]}),e.jsxs(K,{children:[e.jsx(h,{value:"all",children:"All Status"}),e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"paused",children:"Paused"}),e.jsx(h,{value:"completed",children:"Completed"}),e.jsx(h,{value:"draft",children:"Draft"})]})]}),e.jsxs(b,{size:"sm",onClick:f,className:"h-8 text-sm cursor-pointer",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),"Add New"]})]})]})}),e.jsxs(I,{className:"pt-0",children:[e.jsxs(B,{className:"table-dense",children:[e.jsx(H,{children:e.jsxs(j,{children:[e.jsx(N,{className:"text-sm",children:"Campaign Name"}),e.jsx(N,{className:"text-sm",children:"Status"}),e.jsx(N,{className:"text-sm",children:"Target Audience"})]})}),e.jsx(O,{children:g&&a==="LoadingFirstPage"?e.jsx(j,{children:e.jsx(x,{colSpan:4,className:"text-center",children:"Loading campaigns..."})}):i.length===0?e.jsx(j,{children:e.jsx(x,{colSpan:4,className:"text-center",children:"No campaigns found"})}):i.map(s=>e.jsxs(j,{className:"cursor-pointer hover:bg-accent",onClick:()=>void n(`/campaigns/${s._id}/`),children:[e.jsx(x,{className:"font-medium text-sm",children:s.name}),e.jsx(x,{children:e.jsx(E,{variant:"outline",className:"text-sm py-0.5 px-2 "+(s.status==="active"?"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800":s.status==="paused"?"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800":s.status==="completed"?"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800":s.status==="draft"?"bg-foreground/10 text-foreground border-accent dark:bg-background dark:text-gray-300 dark:border-gray-800":"bg-muted text-muted-foreground border-border"),children:s.status})}),e.jsx(x,{className:"text-sm",children:s.targetAudience})]},s._id))})]}),e.jsxs("div",{className:"flex items-center justify-center mt-4",children:[a==="CanLoadMore"&&e.jsx(b,{variant:"outline",onClick:()=>l(10),disabled:g,children:g?"Loading...":"Load More"}),a==="LoadingMore"&&e.jsx(e.Fragment,{children:"Loading..."}),a==="Exhausted"&&i.length>0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No more campaigns"})]})]}),e.jsx(ae,{open:u,onOpenChange:c})]})};export{ue as CampaignsPage,ue as default};
