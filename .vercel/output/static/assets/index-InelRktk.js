import{h as P,r as t,$ as S,j as e,B as u,a0 as h,a as M,b as k,C as O,c as H,d as q,e as Q,f as V}from"./index-BhShMgCK.js";import{a as y}from"./api-CEFOjK8t.js";import{T as R,a as U,b as v,c as C,d as G,e as j}from"./table-CbE_oz1G.js";import{D as E,e as F,f as $,g as I,h as J,i as K,j as W,S as X,a as Y,b as Z,c as ee,d as L}from"./dialog-WUoby_ld.js";import{I as A}from"./input-BHxjlcNQ.js";import{L as w,P as se}from"./label-DNKLp33a.js";import{T as ae,S as te}from"./textarea-C0PX_CFT.js";import{L as re,D as ne}from"./delete-confirmation-dialog-C1rUYhYA.js";import{A as ie}from"./arrow-up-down-DB451iIV.js";import{E as ce}from"./eye-DlfTshQq.js";import{T as le}from"./trash-TkbFw94P.js";import"./index-Bnoxgq91.js";import"./triangle-alert--dCDEp0T.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],D=P("copy",oe),de=({open:x,onOpenChange:r})=>{const[o,g]=t.useState(""),[d,n]=t.useState(""),[a,i]=t.useState(!1),f=S(y.audiences.createAudience),N=async c=>{if(c.preventDefault(),!o.trim()){h.error("Audience name is required");return}i(!0);try{await f({name:o.trim(),description:d.trim()||void 0}),h.success("Audience created successfully"),g(""),n(""),r(!1)}catch(l){h.error(`Error creating audience: ${l.message}`)}finally{i(!1)}};return e.jsx(E,{open:x,onOpenChange:r,children:e.jsx(F,{className:"sm:max-w-[425px]",children:e.jsxs("form",{onSubmit:N,children:[e.jsxs($,{children:[e.jsx(I,{children:"Create New Audience"}),e.jsx(J,{children:"Create a new audience group to organize your leads."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"name",children:"Name"}),e.jsx(A,{id:"name",value:o,onChange:c=>g(c.target.value),placeholder:"Enter audience name",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(ae,{id:"description",value:d,onChange:c=>n(c.target.value),placeholder:"Describe this audience...",rows:3})]})]}),e.jsxs(K,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:a,children:"Cancel"}),e.jsx(u,{type:"submit",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Creating..."]}):"Create Audience"})]})]})})})},me=({audienceId:x,originalName:r,children:o})=>{const[g,d]=t.useState(!1),[n,a]=t.useState(`${r} (Copy)`),[i,f]=t.useState(!1),N=S(y.audiences.cloneAudience),c=async m=>{if(m.preventDefault(),!n.trim()){h.error("Audience name is required");return}f(!0);try{await N({id:x,name:n.trim()}),h.success("Audience cloned successfully"),d(!1),a(`${r} (Copy)`)}catch(b){h.error(`Error cloning audience: ${b.message}`)}finally{f(!1)}},l=m=>{d(m),m&&a(`${r} (Copy)`)};return e.jsxs(E,{open:g,onOpenChange:l,children:[e.jsx(W,{asChild:!0,children:o}),e.jsxs(F,{className:"sm:max-w-md",children:[e.jsx($,{children:e.jsx(I,{children:"Clone Audience"})}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:['Create a copy of "',r,'" with all its leads.']})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"clone-name",className:"text-sm",children:"New audience name"}),e.jsx(A,{id:"clone-name",value:n,onChange:m=>a(m.target.value),placeholder:"Enter name for cloned audience",autoFocus:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:i,children:"Cancel"}),e.jsx(u,{type:"submit",disabled:i||!n.trim(),children:i?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4 animate-pulse"}),"Cloning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Clone"]})})]})]})]})]})};function De(){var T;const[x,r]=t.useState(""),[o,g]=t.useState("name"),[d,n]=t.useState(!1),[a,i]=t.useState({open:!1,audience:null}),[f,N]=t.useState(!1),c=M(),l=k(y.audiences.getAudiences,{search:x||void 0,sortBy:o||void 0}),m=k(y.audiences.getAudiencesCount),b=S(y.audiences.deleteAudience),_=(s,p)=>{i({open:!0,audience:{id:s,name:p}})},z=async()=>{if(a.audience){N(!0);try{await b({id:a.audience.id}),h.success("Audience deleted successfully"),i({open:!1,audience:null})}catch(s){h.error(`Error deleting audience: ${s.message}`)}finally{N(!1)}}},B=s=>new Date(s).toLocaleDateString();return e.jsx(e.Fragment,{children:e.jsxs(O,{className:"border-border m-4",children:[e.jsx(H,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(q,{className:"text-sm",children:"Audiences"}),e.jsxs(Q,{className:"text-sm",children:["Showing ",(l==null?void 0:l.length)||0," of ",m||0," ","audiences"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(u,{size:"sm",onClick:()=>n(!0),className:"w-36 h-9 text-sm cursor-pointer",children:[e.jsx(se,{className:"h-3 w-3"}),"New Audience"]}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-3 w-3 text-muted-foreground"}),e.jsx(A,{placeholder:"Search audiences...",value:x,onChange:s=>r(s.target.value),className:"pl-8 w-48 h-9 text-sm border-border"})]}),e.jsxs(X,{value:o,onValueChange:g,children:[e.jsxs(Y,{className:"w-32 cursor-pointer h-8 border-border text-sm",children:[e.jsx(ie,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Z,{})]}),e.jsxs(ee,{children:[e.jsx(L,{value:"name",children:"Name"}),e.jsx(L,{value:"created",children:"Created"})]})]})]})]})}),e.jsx(V,{className:"pt-0",children:e.jsxs(R,{className:"table-dense",children:[e.jsx(U,{children:e.jsxs(v,{children:[e.jsx(C,{className:"text-sm text-muted-foreground",children:"Name"}),e.jsx(C,{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx(C,{className:"text-sm text-muted-foreground",children:"Leads"}),e.jsx(C,{className:"text-sm text-muted-foreground",children:"Created"}),e.jsx(C,{className:"text-sm text-muted-foreground text-right",children:"Actions"})]})}),e.jsx(G,{children:l?l.length===0?e.jsx(v,{children:e.jsx(j,{colSpan:5,className:"text-center text-muted-foreground",children:x?"No audiences found matching your search":"No audiences created yet"})}):l.map(s=>e.jsxs(v,{className:"cursor-pointer hover:bg-accent",children:[e.jsx(j,{className:"font-medium text-sm hover:underline hover:cursor-pointer hover:text-primary",onClick:()=>c(`/audiences/${s._id}`),children:s.name}),e.jsx(j,{className:"text-sm max-w-xs truncate",children:s.description||"No description"}),e.jsx(j,{className:"text-sm",children:s.leadsCount}),e.jsx(j,{className:"text-sm",children:B(s.createdAt)}),e.jsx(j,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(u,{size:"sm",variant:"outline",onClick:p=>{p.stopPropagation(),c(`/audiences/${s._id}`)},className:"h-8 px-3 cursor-pointer",children:e.jsx(ce,{className:"h-2 w-2"})}),e.jsx(me,{audienceId:s._id,originalName:s.name,children:e.jsx(u,{size:"sm",variant:"outline",onClick:p=>p.stopPropagation(),className:"h-8 px-3 cursor-pointer hover:text-primary",children:e.jsx(D,{className:"h-2 w-2"})})}),e.jsx(u,{size:"sm",variant:"outline",onClick:p=>{p.stopPropagation(),_(s._id,s.name)},className:"h-8 px-3 cursor-pointer hover:text-destructive",children:e.jsx(le,{className:"h-2 w-2"})})]})})]},s._id)):e.jsx(v,{children:e.jsx(j,{colSpan:5,className:"text-center",children:"Loading audiences..."})})})]})}),e.jsx(de,{open:d,onOpenChange:n}),e.jsx(ne,{open:a.open,onOpenChange:s=>i({open:s,audience:null}),onConfirm:z,itemName:(T=a.audience)==null?void 0:T.name,loading:f,description:"This will permanently delete the audience and remove all associated leads from this audience."})]})})}export{De as default};
